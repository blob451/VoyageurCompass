# VoyageurCompass Multilingual Deployment Guide\n\nThis guide provides comprehensive instructions for deploying VoyageurCompass with full multilingual support in production environments.\n\n## Overview\n\nThe multilingual deployment includes:\n- **Frontend**: React SPA with i18next internationalization\n- **Backend**: Django with AI-powered translation service\n- **AI Models**: Ollama with Qwen2:3b for translations\n- **Caching**: Redis for translation cache optimization\n- **Monitoring**: Prometheus, Grafana, and custom metrics\n- **Load Balancing**: Nginx with language-aware routing\n\n## Prerequisites\n\n### System Requirements\n\n#### Minimum Requirements\n- **CPU**: 8 cores (Intel/AMD x64)\n- **RAM**: 16GB (8GB for Ollama models + 8GB for services)\n- **Storage**: 100GB SSD (50GB for models + 50GB for data)\n- **Network**: 1Gbps connection\n\n#### Recommended Requirements\n- **CPU**: 16 cores with GPU (NVIDIA RTX 3080+ or equivalent)\n- **RAM**: 32GB (16GB for Ollama + 16GB for services)\n- **Storage**: 200GB NVMe SSD\n- **Network**: 10Gbps connection\n\n### Software Dependencies\n\n```bash\n# Install Docker and Docker Compose\ncurl -fsSL https://get.docker.com -o get-docker.sh\nsudo sh get-docker.sh\nsudo curl -L \"https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n\n# Install Ollama\ncurl -fsSL https://ollama.ai/install.sh | sh\n\n# Install required models\nollama pull qwen2:3b\nollama pull llama3.1:8b\n```\n\n## Deployment Steps\n\n### 1. Environment Setup\n\n```bash\n# Clone the repository\ngit clone <repository-url>\ncd VoyageurCompass\n\n# Create environment directory\nmkdir -p deployment/env\n```\n\n### 2. Configuration Files\n\n#### Create Production Environment Variables\n\n```bash\n# deployment/env/production.env\nDJANGO_SECRET_KEY=your-super-secret-key-here\nDJANGO_DEBUG=False\nDJANGO_ALLOWED_HOSTS=voyageurcompass.com,www.voyageurcompass.com,fr.voyageurcompass.com,es.voyageurcompass.com\n\n# Database Configuration\nPOSTGRES_DB=voyageur_compass\nPOSTGRES_USER=voyageur\nPOSTGRES_PASSWORD=your-secure-password\nPOSTGRES_HOST=postgres\nPOSTGRES_PORT=5432\n\n# Redis Configuration\nREDIS_URL=redis://redis:6379/0\nREDIS_CACHE_URL=redis://redis:6379/1\nREDIS_TRANSLATION_URL=redis://redis:6379/2\n\n# Multilingual Configuration\nENABLE_TRANSLATIONS=true\nTRANSLATION_MODEL=qwen2:3b\nSUPPORTED_LANGUAGES=en,fr,es\nDEFAULT_LANGUAGE=en\nTRANSLATION_QUALITY_THRESHOLD=0.7\nTRANSLATION_CACHE_TTL_HIGH=7200\nTRANSLATION_CACHE_TTL_STANDARD=1800\nTRANSLATION_CACHE_TTL_LOW=300\n\n# Ollama Configuration\nOLLAMA_BASE_URL=http://ollama:11434\nOLLAMA_TIMEOUT=60\nOLLAMA_MAX_CONCURRENT_REQUESTS=10\n\n# Performance Settings\nGUNICORN_WORKERS=4\nGUNICORN_WORKER_CONNECTIONS=1000\nGUNICORN_TIMEOUT=120\n\n# Monitoring\nPROMETHEUS_ENABLED=true\nMETRICS_EXPORT_PORT=9090\nLOG_LEVEL=INFO\nTRANSLATION_METRICS_ENABLED=true\n\n# Security\nSSL_CERTIFICATE_PATH=/etc/ssl/certs/voyageur.crt\nSSL_PRIVATE_KEY_PATH=/etc/ssl/private/voyageur.key\nCSRF_COOKIE_SECURE=true\nSESSION_COOKIE_SECURE=true\nSECURE_SSL_REDIRECT=true\n```\n\n### 3. SSL Certificate Setup\n\n```bash\n# Create SSL directory\nmkdir -p deployment/ssl\n\n# Option 1: Self-signed certificates (development)\nopenssl req -x509 -nodes -days 365 -newkey rsa:2048 \\\n  -keyout deployment/ssl/key.pem \\\n  -out deployment/ssl/cert.pem \\\n  -subj \"/C=US/ST=State/L=City/O=Organization/CN=voyageurcompass.com\"\n\n# Option 2: Let's Encrypt certificates (production)\ncertbot certonly --nginx -d voyageurcompass.com -d www.voyageurcompass.com\ncp /etc/letsencrypt/live/voyageurcompass.com/fullchain.pem deployment/ssl/cert.pem\ncp /etc/letsencrypt/live/voyageurcompass.com/privkey.pem deployment/ssl/key.pem\n```\n\n### 4. Model Preparation\n\n```bash\n# Create models directory\nmkdir -p deployment/models\n\n# Download and verify translation model\ndocker run --rm -v $(pwd)/deployment/models:/models ollama/ollama:latest \\\n  bash -c \"ollama pull qwen2:3b && ollama list\"\n\n# Verify model files\nls -la deployment/models/\n```\n\n### 5. Database Initialization\n\n```bash\n# Start database service\ndocker-compose -f infrastructure/deployment/multilingual-config.yml up -d postgres redis\n\n# Wait for services to be ready\nsleep 30\n\n# Run database migrations\ndocker-compose -f infrastructure/deployment/multilingual-config.yml exec voyageur-app \\\n  python manage.py migrate\n\n# Create superuser\ndocker-compose -f infrastructure/deployment/multilingual-config.yml exec voyageur-app \\\n  python manage.py createsuperuser\n\n# Load initial data (optional)\ndocker-compose -f infrastructure/deployment/multilingual-config.yml exec voyageur-app \\\n  python manage.py loaddata fixtures/initial_data.json\n```\n\n### 6. Full Deployment\n\n```bash\n# Deploy all services\ndocker-compose -f infrastructure/deployment/multilingual-config.yml up -d\n\n# Verify services are running\ndocker-compose -f infrastructure/deployment/multilingual-config.yml ps\n\n# Check logs\ndocker-compose -f infrastructure/deployment/multilingual-config.yml logs -f\n```\n\n### 7. Monitoring Setup\n\n```bash\n# Deploy monitoring stack\ndocker-compose -f infrastructure/monitoring/multilingual-monitoring.yml up -d\n\n# Access monitoring dashboards\necho \"Prometheus: http://localhost:9090\"\necho \"Grafana: http://localhost:3000 (admin/admin123)\"\necho \"AlertManager: http://localhost:9093\"\n```\n\n## Post-Deployment Verification\n\n### 1. Health Checks\n\n```bash\n# Check application health\ncurl -f http://localhost/health/\n\n# Check translation service\ncurl -X POST http://localhost/api/analytics/explain/ \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"symbol\":\"AAPL\",\"language\":\"fr\"}'\n\n# Verify language switching\ncurl -H \"Accept-Language: fr-FR\" http://localhost/\n```\n\n### 2. Performance Testing\n\n```bash\n# Install testing tools\nnpm install -g artillery\n\n# Run performance tests\narty run infrastructure/testing/performance-test.yml\n\n# Translation performance test\npython manage.py benchmark_translation_performance --languages fr,es --iterations 50\n```\n\n### 3. Translation Quality Verification\n\n```bash\n# Run translation quality tests\npython manage.py test Analytics.tests.test_translation_quality\n\n# Manual verification\npython manage.py shell\n>>> from Analytics.services.translation_service import TranslationService\n>>> service = TranslationService()\n>>> result = service.translate_text(\"Apple stock shows strong performance\", \"fr\")\n>>> print(result)\n```\n\n## Scaling Configuration\n\n### Horizontal Scaling\n\n```yaml\n# docker-compose.scale.yml\nversion: '3.8'\nservices:\n  voyageur-app:\n    deploy:\n      replicas: 3\n    environment:\n      - GUNICORN_WORKERS=6\n  \n  ollama:\n    deploy:\n      replicas: 2\n    environment:\n      - OLLAMA_PARALLEL_REQUESTS=5\n```\n\n```bash\n# Scale services\ndocker-compose -f infrastructure/deployment/multilingual-config.yml \\\n  -f docker-compose.scale.yml up -d --scale voyageur-app=3\n```\n\n### Load Balancer Configuration\n\n```nginx\n# Enhanced upstream configuration\nupstream voyageur_backend {\n    least_conn;\n    server voyageur-app-1:8000 weight=3 max_fails=3 fail_timeout=30s;\n    server voyageur-app-2:8000 weight=3 max_fails=3 fail_timeout=30s;\n    server voyageur-app-3:8000 weight=3 max_fails=3 fail_timeout=30s;\n    keepalive 32;\n}\n\n# Session affinity for translation requests\nip_hash;\n```\n\n## Monitoring and Alerting\n\n### Key Metrics to Monitor\n\n#### Translation Service Metrics\n- **Translation Request Rate**: Requests per second by language\n- **Translation Response Time**: P50, P95, P99 latencies\n- **Translation Quality Score**: Average quality by language\n- **Cache Hit Rate**: Translation cache efficiency\n- **Model Availability**: Ollama service uptime\n- **Error Rate**: Failed translation percentage\n\n#### System Metrics\n- **CPU Usage**: Per service and overall\n- **Memory Usage**: Including model memory consumption\n- **Disk I/O**: Cache and model storage\n- **Network**: Request throughput and latency\n\n#### Application Metrics\n- **User Sessions**: Active users by language\n- **Language Usage**: Distribution of language preferences\n- **Feature Adoption**: Multilingual feature usage\n- **User Experience**: Language switching frequency\n\n### Alert Rules\n\n```yaml\n# alertmanager/rules/multilingual.yml\ngroups:\n- name: translation_service\n  rules:\n  - alert: HighTranslationLatency\n    expr: translation_response_time_p95 > 5000\n    for: 2m\n    labels:\n      severity: warning\n    annotations:\n      summary: \"High translation response time detected\"\n      description: \"Translation P95 latency is {{ $value }}ms\"\n\n  - alert: TranslationServiceDown\n    expr: up{job=\"translation-exporter\"} == 0\n    for: 1m\n    labels:\n      severity: critical\n    annotations:\n      summary: \"Translation service is down\"\n\n  - alert: LowTranslationQuality\n    expr: avg_translation_quality < 0.7\n    for: 5m\n    labels:\n      severity: warning\n    annotations:\n      summary: \"Translation quality below threshold\"\n\n  - alert: HighTranslationErrorRate\n    expr: translation_error_rate > 0.05\n    for: 2m\n    labels:\n      severity: critical\n    annotations:\n      summary: \"High translation error rate: {{ $value }}\"\n```\n\n## Backup and Recovery\n\n### Database Backup\n\n```bash\n#!/bin/bash\n# backup-db.sh\nBACKUP_DIR=\"/backups/postgres/$(date +%Y-%m-%d)\"\nmkdir -p $BACKUP_DIR\n\ndocker-compose exec postgres pg_dump -U voyageur voyageur_compass | \\\n  gzip > \"$BACKUP_DIR/database-$(date +%H%M%S).sql.gz\"\n\n# Retention policy: keep 30 days\nfind /backups/postgres -type d -mtime +30 -exec rm -rf {} \\;\n```\n\n### Translation Cache Backup\n\n```bash\n#!/bin/bash\n# backup-translations.sh\nBACKUP_DIR=\"/backups/translations/$(date +%Y-%m-%d)\"\nmkdir -p $BACKUP_DIR\n\n# Backup Redis translation cache\ndocker-compose exec redis redis-cli --rdb - | \\\n  gzip > \"$BACKUP_DIR/translation-cache-$(date +%H%M%S).rdb.gz\"\n```\n\n### Recovery Procedures\n\n```bash\n# Database recovery\ngunzip < backup.sql.gz | docker-compose exec -T postgres psql -U voyageur voyageur_compass\n\n# Translation cache recovery\ngunzip < translation-cache.rdb.gz | docker-compose exec -T redis redis-cli --pipe\n\n# Verify recovery\ndocker-compose exec voyageur-app python manage.py check --database default\n```\n\n## Security Considerations\n\n### Network Security\n\n```bash\n# Firewall configuration\nsudo ufw allow 22/tcp      # SSH\nsudo ufw allow 80/tcp      # HTTP\nsudo ufw allow 443/tcp     # HTTPS\nsudo ufw allow 9090/tcp    # Prometheus (internal only)\nsudo ufw enable\n\n# Docker network isolation\ndocker network create --driver bridge --subnet=172.20.0.0/16 voyageur_internal\n```\n\n### Data Protection\n\n```python\n# Django settings for production\nSECRET_KEY = os.environ['DJANGO_SECRET_KEY']\nDEBUG = False\nSECURE_SSL_REDIRECT = True\nSECURE_HSTS_SECONDS = 31536000\nSECURE_HSTS_INCLUDE_SUBDOMAINS = True\nCSRF_COOKIE_SECURE = True\nSESSION_COOKIE_SECURE = True\n\n# Translation data encryption\nTRANSLATION_ENCRYPTION_KEY = os.environ['TRANSLATION_ENCRYPTION_KEY']\n```\n\n### Access Control\n\n```nginx\n# Rate limiting for different endpoints\nlimit_req_zone $binary_remote_addr zone=translation:10m rate=10r/s;\nlimit_req_zone $binary_remote_addr zone=api:10m rate=30r/s;\nlimit_req_zone $binary_remote_addr zone=admin:10m rate=5r/s;\n```\n\n## Troubleshooting\n\n### Common Issues\n\n#### 1. Translation Model Not Loading\n\n```bash\n# Check Ollama service status\ndocker-compose logs ollama\n\n# Verify model is available\ndocker-compose exec ollama ollama list\n\n# Re-pull model if necessary\ndocker-compose exec ollama ollama pull qwen2:3b\n```\n\n#### 2. High Translation Latency\n\n```bash\n# Check system resources\ndocker stats\n\n# Monitor translation cache hit rate\ndocker-compose exec redis redis-cli info stats\n\n# Analyze slow queries\ndocker-compose logs voyageur-app | grep -i \"translation.*slow\"\n```\n\n#### 3. Language Detection Issues\n\n```bash\n# Test language detection\ncurl -H \"Accept-Language: fr-FR,fr;q=0.9,en;q=0.8\" \\\n  -v http://localhost/api/analytics/explain/\n\n# Check nginx language mapping\ndocker-compose exec nginx nginx -T | grep -A 10 \"accept_language\"\n```\n\n#### 4. Cache Issues\n\n```bash\n# Clear translation cache\ndocker-compose exec redis redis-cli FLUSHDB 2\n\n# Monitor cache performance\ndocker-compose exec redis redis-cli monitor\n```\n\n### Log Analysis\n\n```bash\n# Application logs\ndocker-compose logs -f voyageur-app | grep -i translation\n\n# Translation service logs\ndocker-compose exec voyageur-app tail -f /app/logs/translations.log\n\n# Nginx access logs with language information\ndocker-compose logs nginx | grep -E \"(lang=|accept_lang=)\"\n```\n\n## Maintenance\n\n### Regular Maintenance Tasks\n\n#### Daily\n- Monitor system health and performance metrics\n- Check translation quality scores\n- Review error logs for translation failures\n- Verify backup completion\n\n#### Weekly\n- Update translation cache statistics\n- Analyze language usage patterns\n- Review and update translation quality thresholds\n- Performance benchmarking\n\n#### Monthly\n- Update AI models if newer versions available\n- Review and optimize translation prompts\n- Analyze user feedback on translations\n- Security updates and patches\n\n### Update Procedures\n\n```bash\n# Update application code\ngit pull origin main\ndocker-compose build voyageur-app\ndocker-compose up -d voyageur-app\n\n# Update AI models\ndocker-compose exec ollama ollama pull qwen2:3b\ndocker-compose restart voyageur-app\n\n# Update translation files\n# (Update translation JSON files)\ndocker-compose exec voyageur-app python manage.py collectstatic --noinput\ndocker-compose restart nginx\n```\n\n## Performance Optimization\n\n### Database Optimization\n\n```sql\n-- Index optimization for translation queries\nCREATE INDEX CONCURRENTLY idx_translations_language_hash \nON translation_cache(language, content_hash);\n\nCREATE INDEX CONCURRENTLY idx_translations_created_at \nON translation_cache(created_at DESC);\n```\n\n### Cache Optimization\n\n```python\n# Redis configuration optimization\nREDIS_SETTINGS = {\n    'maxmemory': '2gb',\n    'maxmemory-policy': 'allkeys-lru',\n    'tcp-keepalive': 300,\n    'timeout': 0,\n    'save': '900 1 300 10 60 10000'\n}\n```\n\n### Model Optimization\n\n```bash\n# Optimize Ollama for production\nexport OLLAMA_NUM_PARALLEL=4\nexport OLLAMA_MAX_LOADED_MODELS=2\nexport OLLAMA_FLASH_ATTENTION=1\n```\n\n---\n\n**Note**: This deployment guide assumes a Linux-based production environment. For Windows or macOS deployments, adjust paths and commands accordingly. Always test deployments in a staging environment before production rollout."